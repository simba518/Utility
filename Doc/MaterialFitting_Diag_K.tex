\documentclass[9pt,twocolumn]{extarticle}

\usepackage[hmargin=0.5in,tmargin=0.5in]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{times}
\usepackage{graphicx}
\usepackage{subfigure}

\usepackage{cleveref}
\usepackage{color}
\newcommand{\TODO}[1]{\textcolor{red}{#1}}

\newcommand{\FPP}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\argmin}{\operatornamewithlimits{arg\ min}}
\author{Siwang Li}

\title{Full-space Material Fitting}

%% document begin here
\begin{document}
\maketitle

\setlength{\parskip}{0.5ex}

\section{Introduction}
Given the optimized modal basis $W=\hat{W}S$, the corresponding eigenvalues
$\Lambda$, we solve for the Shear modulus $G=(G_1,\cdots,G_{tet})$, Lame's first
parameter $l=(l_1,\cdots,l_{tet})$ for all tetrahedrons. We require that, with
suitable material $G,l$, the motion equation should be diagonalized by the basis
$W$. And if the density is also given, we can further transform the basis using
the real mass matrix, and use it to compute $G,l$.

\section{Algorithm}
The motion equation is
\begin{equation} \label{motion-eq}
  M(\rho)\ddot{x} + K(G,l)x = 0
\end{equation}
This motion equation should be diagonalized by $W$, thus we can solve the
following problem for $\rho,G,l$,
\begin{equation} \label{obj1}
  \min_{\rho,G,l}\frac{1}{2}(\|W^TM(\rho)W-I\|_2^2+\|W^TK(G,l)W-\Lambda\|_2^2)
\end{equation}
If the real density is known, and the corresponding mass matrix is $\tilde{M}$,
then let $x=({M}^{-\frac{1}{2}}\tilde{M}^{\frac{1}{2}})y$, and left multiply the
motion equation (\ref{motion-eq}) with
$({M}^{-\frac{1}{2}}\tilde{M}^{\frac{1}{2}})^T$, we obtain
\begin{equation} \label{motion-eq2}
  \tilde{M}\ddot{y} + \tilde{K}(G,l)y = 0
\end{equation}
If we compute $\tilde{W}=\tilde{M}^{-\frac{1}{2}}M^{\frac{1}{2}}W$, then it is
obviously that $\tilde{W}^T\tilde{M}\tilde{W}=I$, and the desired $G,l$ should
satisfy $\tilde{W}^T\tilde{K}(G,l)\tilde{W}=\Lambda$.

As a conclusion, we solve for $G,l$ as following,
\begin{itemize}
\item Solve for the density $\rho$,
  \begin{equation} \label{rho}
    \min_{\rho}\frac{1}{2}\|W^TM(\rho)W-I\|_2^2+\mu_{r}\phi_s(\rho), 
  \end{equation}
  \[
  \mbox{s.t. } \rho_i>0
  \]
\item Use mass matrix $\tilde{M}$ and $M$ to transform the basis matrix $W$ as
  \begin{equation} \label{W_ext}
    \tilde{W}=\tilde{M}^{-\frac{1}{2}}M^{\frac{1}{2}}W
  \end{equation}
\item Solve for the $G,l$ using
\begin{equation} \label{gl}
  \min_{G,l}\frac{1}{2}\|\tilde{W}^T\tilde{K}(G,l)\tilde{W}-\Lambda\|_2^2+\mu_{g}\phi_s(G)+\mu_{l}\phi_s(l)
\end{equation}
  \[
  \mbox{s.t. }  G_i>0 \mbox{, } l_i>0
  \]
\end{itemize}
where $\mu_r, \mu_g, \mu_l$ are some penalty parameters, and
\begin{equation} \label{smooth}
  \phi_s(x) = \frac{1}{2}\sum_{(i,j)_{n}}(x_i-x_j)^2V_{i,j}, \mbox{ for all
    tet. }i
\end{equation}
indicates that the material should be smooth, where $(i,j)_{n}$ indicates a
neighbor tetrahedron pair, $V_{i,j}=\frac{1}{4}(v_i+v_j)$ with $v_i$ is the
volume of tetrahedron $i$.

\subsection{Constrained Nodes}
For constrained nodes, we first remove the corresponding columns and rows from
$\tilde{K}, \tilde{M}, M$, and remove the corresponding rows in $W$, then use
them to solve for $\rho,G,l$.

\section{Results}


\end{document}