\documentclass[twocolumn]{article}
\usepackage {bibentry}
\setlength{\columnsep}{3em}
\author{Siwang Li}
\title{Static Deformation In Subspace}

\begin{document}
\maketitle

\section{Dynamic Simulation}
For dynamic simulation in real-time, we adopt the subspace method, where the
motion equation is
\begin{equation}\label{red_eq}
M\ddot{q} + D(q)\dot{q} + f(q) = f_{e}
\end{equation}
and usually the position constraints can be expressed as
\[
{C} q = u_c
\]
Here ${C}$ is the constraint matrix in the subspace, and $u_c$ is the
displacements of the constrained nodes in full space.

\section{Static Deformation}
For static deformation, the speed and acceleration in
equation(\ref{red_eq})should be 0, and we only have to solve
\[
f(q) = f_{e}
\]
subject to
\[
{C} q = u_c
\]
\subsection{Lagrange Method}
According to the Lagrange's mechanics with constraints, we have
\begin{equation}\label{lag_1}
  \left\{ \begin{array}{rl}
      &f(q) + C^T\lambda = f_{e} \\
      &Cq = u_c
    \end{array} \right.
\end{equation}
Then we have only to solve a nonlinear equation $r(q) = 0$, where  
\[
r(q) =   \left[ \begin{array}{c}
    f(q)+C^T\lambda - f_{e}\\
    Cq - u_c
  \end{array} \right]
\]
and the Jacobin is
\[
J(q) = \left[ \begin{array}{cc}
    K(q) & C^T\\
    C & O
  \end{array} \right]
\]
here $K(q)$ is the stiffness matrix. Then Newton's method can be adopted to
solve this nonlinear equation, and the result $q$ is the deformed status. \\\\
This method has been implemented in the class RedStVKStaticDefLagCon. However
it's failed to solve $r(q)=0$ with Newton's approach, as $J(q)$ always be highly
ill-conditioned.

\subsection{Penalty Method}
With penalty method, we solve 
\[
f(q)+ \lambda_c \frac{d\|Cq-u_c\|_2^2}{dq}= f_{e} 
\]
to get the deformed result. Here $\lambda_c$ is the penalty coefficient. Then we
have to solve $r(q) = 0$ , where
\[
r(q) = f(q)+ \lambda_c (C^TCq - C^Tu_c)-f_{e} 
\]
and 
\[
J(q) = K(q) + \lambda_c C^TC
\]
This method has been implemented in the class RedStVKStaticDefPenCon, and it
works. But in current implementation, external forces is not supported ,e.g
$f_{e}$ is always be 0.

\end{document}
